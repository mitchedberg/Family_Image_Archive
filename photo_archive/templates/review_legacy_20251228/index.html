<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <title>Bucket Review</title>
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <div id="app" class="app">
      <header class="app__topbar">
        <div class="topbar">
          <div class="topbar__group topbar__group--summary">
            <span class="app-label">Bucket Review</span>
            <span id="summary" class="summary-text"></span>
            <span id="status-bar" class="status-bar"></span>
          </div>
          <div class="topbar__group topbar__group--nav" role="group" aria-label="Bucket navigation">
            <button id="btn-prev" type="button" aria-label="Previous bucket">← Prev (K)</button>
            <button id="btn-next" type="button" aria-label="Next bucket">Next (J) →</button>
            <div class="segmented" id="compare-toggle" role="group" aria-label="Compare mode">
              <button type="button" data-compare="ai" aria-pressed="true">Original ↔ AI</button>
              <button type="button" data-compare="back" aria-pressed="false">Original ↔ Back</button>
            </div>
          </div>
          <div class="topbar__group topbar__group--actions">
            <button id="notes-toggle" type="button" aria-expanded="false">Notes</button>
            <button id="filter-toggle" type="button" aria-expanded="false">Filters</button>
            <button id="help-toggle" type="button" aria-expanded="false" aria-controls="shortcut-panel">?</button>
          </div>
        </div>
        <div id="filter-panel" class="filter-panel" aria-hidden="true">
          <div class="filter-panel__header">
            <strong>Filters</strong>
            <button id="filter-close" type="button" aria-label="Close filters">✕</button>
          </div>
          <div class="filter-panel__group">
            <div class="filter-panel__label">Sources</div>
            <div id="source-filters" class="chip-group"></div>
          </div>
          <div class="filter-panel__group">
            <div class="filter-panel__label">Variants</div>
            <div id="variant-filters" class="chip-group">
              <button type="button" class="chip" data-variant-filter="has_back">Has Back</button>
              <button type="button" class="chip" data-variant-filter="has_ai">Has AI</button>
              <button type="button" class="chip" data-variant-filter="missing_ai">No AI</button>
            </div>
          </div>
        </div>
        <div id="shortcut-panel" class="shortcut-panel" aria-hidden="true">
          <div class="shortcut-panel__header">
            <strong>Keyboard Shortcuts</strong>
            <button id="shortcut-close" type="button" aria-label="Close shortcuts">✕</button>
          </div>
          <div id="shortcut-bar" class="shortcut-bar"></div>
        </div>
      </header>
      <main class="review-main">
        <section class="stage">
          <div class="image-toolbar" role="toolbar" aria-label="Image tools">
            <div class="image-toolbar__group image-toolbar__group--grow">
              <span class="image-toolbar__label">Zoom</span>
              <button id="zoom-out" type="button" aria-label="Zoom out">−</button>
              <input id="zoom-slider" type="range" min="1" max="4" step="0.1" value="1" aria-label="Zoom slider" />
              <button id="zoom-in" type="button" aria-label="Zoom in">+</button>
              <span id="zoom-value">1.0×</span>
              <button id="zoom-reset" type="button">Reset View</button>
              <button id="fullres-toggle" type="button" class="toggle-button" aria-pressed="false">Full Res OFF</button>
            </div>
          </div>
          <div id="bucket-container" class="bucket-container"></div>
        </section>
      </main>
      <aside id="note-drawer" class="note-drawer note-drawer--collapsed" aria-expanded="false">
        <div class="note-drawer__header">
          <div class="note-drawer__title-group">
            <div class="note-drawer__title">
              <strong>Notes &amp; Transcripts</strong>
              <span class="note-panel__hint">Voice + OCR stay read-only; add context in Manual Notes.</span>
            </div>
            <span id="note-bucket-chip" class="note-bucket-chip"></span>
          </div>
          <div class="note-drawer__header-actions">
            <button id="note-copy-voice" type="button">Voice → Manual</button>
            <button id="note-copy-ocr" type="button">OCR → Manual</button>
            <button id="note-drawer-collapse" type="button" aria-label="Collapse notes">Collapse</button>
            <button id="notes-toggle-secondary" type="button" aria-label="Cycle note drawer size">Cycle Size</button>
          </div>
        </div>
        <div class="note-summary">
          <div class="note-summary__item">
            <span>Voice</span>
            <div id="note-summary-voice" class="note-summary__body note-muted">No voice transcripts.</div>
          </div>
          <div class="note-summary__item">
            <span>OCR</span>
            <div id="note-summary-ocr" class="note-summary__body note-muted">No OCR text yet.</div>
          </div>
          <div class="note-summary__item">
            <span>Manual</span>
            <div id="note-summary-manual" class="note-summary__body note-muted">No manual notes.</div>
          </div>
        </div>
        <div class="note-tabs" role="tablist">
          <button type="button" data-note-tab="voice" aria-selected="true">Voice</button>
          <button type="button" data-note-tab="ocr" aria-selected="false">OCR</button>
          <button type="button" data-note-tab="manual" aria-selected="false">Manual</button>
        </div>
        <div class="note-drawer__body">
          <section class="note-panel" data-note-panel="voice" role="tabpanel" aria-label="Voice transcripts">
            <div id="voice-transcript-list" class="note-readonly note-readonly--scroll"></div>
          </section>
          <section class="note-panel note-panel--hidden" data-note-panel="ocr" role="tabpanel" aria-label="OCR text">
            <div id="ocr-readonly" class="note-readonly note-readonly--scroll"></div>
          </section>
          <section class="note-panel note-panel--hidden" data-note-panel="manual" role="tabpanel" aria-label="Manual notes">
            <div class="note-panel__label">
              <div class="note-panel__label-heading">
                <span id="note-lock-indicator" class="note-lock-indicator">Notes locked</span>
              </div>
              <div class="note-panel__actions">
                <button id="ocr-back-button" type="button">OCR Back → Notes</button>
                <button id="mark-verified-button" type="button">Mark Verified (V)</button>
                <button id="mark-draft-button" type="button">Mark Draft</button>
                <button id="note-edit-toggle" type="button">Unlock Editing</button>
              </div>
            </div>
            <textarea id="note-input" rows="3" placeholder="Manual notes (read-only until unlocked)." readonly></textarea>
            <div class="note-panel__add">
              <textarea id="note-add-input" rows="2" placeholder="Add new note…"></textarea>
              <button id="note-add-button" type="button">Add Note</button>
            </div>
          </section>
        </div>
        <div class="note-panel__meta">
          <span id="ocr-status"></span>
          <span id="note-status"></span>
        </div>
      </aside>
    </div>
    <div id="state-overlay" class="state-overlay" aria-live="polite"></div>
    <script src="review_data.js"></script>
    <script src="review_app.js"></script>
  </body>
</html>
